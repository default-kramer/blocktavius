<Window x:Class="Blocktavius.AppDQB2.PlanScriptDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Blocktavius.AppDQB2"
        mc:Ignorable="d"
        Title="{Binding Title}"
        SizeToContent="WidthAndHeight" MaxHeight="800" MaxWidth="800">
    <StackPanel Orientation="Vertical" Margin="8">
        <StackPanel Grid.Row="0" Orientation="Vertical" HorizontalAlignment="Center">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Label VerticalAlignment="Center">From:</Label>
                <TextBox VerticalAlignment="Center" Text="{Binding SourceSlotName, Mode=OneWay}" IsReadOnly="True" Padding="3,1,3,1"></TextBox>
            </StackPanel>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Label VerticalAlignment="Center">To:</Label>
                <ComboBox MinWidth="75" VerticalAlignment="Center" IsEnabled="{Binding IsNotDone}"
                          ItemsSource="{Binding Project.DestSlots}" SelectedItem="{Binding Project.SelectedDestSlot}" DisplayMemberPath="Name"></ComboBox>
            </StackPanel>
            <StackPanel Margin="0,8,0,0" Orientation="Horizontal" HorizontalAlignment="Center">
                <Label VerticalAlignment="Center">Include:</Label>
                <ComboBox MinWidth="75" VerticalAlignment="Center" IsEnabled="{Binding IsNotDone}"
                          ItemsSource="{Binding Project.InclusionModes}" SelectedItem="{Binding Project.SelectedInclusionMode}" DisplayMemberPath="DisplayName"></ComboBox>
            </StackPanel>
            <TextBlock Margin="0,20,0,0" TextWrapping="Wrap"><Run Text="From:  "></Run><Run Text="{Binding Project.SelectedSourceSlot.FullPath, Mode=OneWay}"></Run></TextBlock>
            <TextBlock Margin="0,3,0,0" TextWrapping="Wrap"><Run Text="     To:  "></Run><Run Text="{Binding Project.SelectedDestSlot.FullPath, Mode=OneWay}"></Run></TextBlock>
            <TextBlock Margin="0,3,0,0" TextWrapping="Wrap">
                <TextBlock.Style>
                    <Style TargetType="{x:Type TextBlock}">
                        <Setter Property="Visibility" Value="Visible"></Setter>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding DestIsSource}" Value="False">
                                <Setter Property="Visibility" Value="Collapsed"></Setter>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
                Source and Destination are the same. Nothing needs to be copied.
            </TextBlock>
        </StackPanel>
        <ListView ItemsSource="{Binding PlanItems}" HorizontalAlignment="Center" Margin="0,6,0,0" MaxHeight="340">
            <ListView.ItemContainerStyle>
                <Style TargetType="{x:Type ListViewItem}">
                    <Setter Property="Focusable" Value="False"></Setter>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView AllowsColumnReorder="False">
                    <GridView.ColumnHeaderContainerStyle>
                        <!-- Disallow column resizing -->
                        <Style TargetType="GridViewColumnHeader">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="GridViewColumnHeader">
                                        <Border BorderThickness="0,0,1,0" BorderBrush="LightGray">
                                            <ContentPresenter Margin="6,0,6,0" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </GridView.ColumnHeaderContainerStyle>
                    <GridViewColumn Header="Backup?">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <RadioButton IsEnabled="False" IsChecked="{Binding WillBeBackedUp, Mode=OneWay}"></RadioButton>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Copy?">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <RadioButton IsEnabled="False" IsChecked="{Binding WillBeCopied, Mode=OneWay}"></RadioButton>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Modify?">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <RadioButton IsEnabled="False" IsChecked="{Binding WillBeModified, Mode=OneWay}"></RadioButton>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="File" DisplayMemberBinding="{Binding ShortName}"></GridViewColumn>
                    <GridViewColumn Header="Status" Width="90">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Grid>
                                    <TextBlock VerticalAlignment="Center" Text="{Binding Status, Mode=OneWay}">
                                        <TextBlock.Style>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="Visibility" Value="Collapsed"></Setter>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding StatusToolTip}" Value="">
                                                        <Setter Property="Visibility" Value="Visible"></Setter>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                    <TextBlock VerticalAlignment="Center">
                                        <TextBlock.Style>
                                            <Style TargetType="{x:Type TextBlock}">
                                                <Setter Property="Visibility" Value="Visible"></Setter>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding StatusToolTip}" Value="">
                                                        <Setter Property="Visibility" Value="Collapsed"></Setter>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                        <Hyperlink Click="Hyperlink_Click"><TextBlock Text="{Binding Status, Mode=OneWay}"></TextBlock></Hyperlink>
                                    </TextBlock>
                                </Grid>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>
        <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
            <Grid Margin="0,4,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" TextWrapping="Wrap" Text="{Binding BackupMessage}" HorizontalAlignment="Center"></TextBlock>
                <TextBlock Grid.Column="0" TextWrapping="Wrap" Text="{Binding BackupWarning}" Foreground="Red" HorizontalAlignment="Center"></TextBlock>
            </Grid>
            <StackPanel Orientation="Horizontal" Margin="0,12,0,0" HorizontalAlignment="Center">
                <Button FontSize="16" Padding="7,2" Click="OkButton_Click" IsEnabled="{Binding CanExecute}">
                    <StackPanel Orientation="Vertical">
                        <TextBlock HorizontalAlignment="Center">Run Script:</TextBlock>
                        <TextBlock HorizontalAlignment="Center" Text="{Binding ScriptName}"></TextBlock>
                    </StackPanel>
                </Button>
                <Button FontSize="16" Padding="7,2" Margin="12,0,0,0" IsCancel="True">
                    <TextBlock>
                        <TextBlock.Style>
                            <Style TargetType="{x:Type TextBlock}">
                                <Setter Property="Text" Value="Cancel"></Setter>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsDone}" Value="True">
                                        <Setter Property="Text" Value="Close"></Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Button>
            </StackPanel>
            <TextBlock Margin="0,4,0,16" Text="{Binding RunScriptError}" TextWrapping="Wrap" HorizontalAlignment="Center" Foreground="Red"></TextBlock>
        </StackPanel>
    </StackPanel>
</Window>
